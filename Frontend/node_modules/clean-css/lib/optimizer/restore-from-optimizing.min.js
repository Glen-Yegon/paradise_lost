var Hack=require("./hack"),Marker=require("../tokenizer/marker"),ASTERISK_HACK="*",BACKSLASH_HACK="\\",IMPORTANT_TOKEN="!important",UNDERSCORE_HACK="_",BANG_HACK="!ie";function restoreFromOptimizing(e,a){var r,t,n,o;for(o=e.length-1;o>=0;o--)(r=e[o]).dynamic&&r.important?restoreImportant(r):r.dynamic||r.unused||(r.dirty||r.important||r.hack)&&(r.optimizable&&a?(t=a(r),r.value=t):t=r.value,r.important&&restoreImportant(r),r.hack&&restoreHack(r),"all"in r&&((n=r.all[r.position])[1][1]=r.name,n.splice(2,n.length-1),Array.prototype.push.apply(n,t)))}function restoreImportant(e){e.value[e.value.length-1][1]+=IMPORTANT_TOKEN}function restoreHack(e){e.hack[0]==Hack.UNDERSCORE?e.name=UNDERSCORE_HACK+e.name:e.hack[0]==Hack.ASTERISK?e.name=ASTERISK_HACK+e.name:e.hack[0]==Hack.BACKSLASH?e.value[e.value.length-1][1]+=BACKSLASH_HACK+e.hack[1]:e.hack[0]==Hack.BANG&&(e.value[e.value.length-1][1]+=Marker.SPACE+BANG_HACK)}module.exports=restoreFromOptimizing;