var Marker=require("../../tokenizer/marker"),Selector={ADJACENT_SIBLING:"+",DESCENDANT:">",DOT:".",HASH:"#",NON_ADJACENT_SIBLING:"~",PSEUDO:":"},LETTER_PATTERN=/[a-zA-Z]/,NOT_PREFIX=":not(",SEPARATOR_PATTERN=/[\s,(>~+]/;function specificity(e){var r,E,T,O,S,t,A,N=[0,0,0],_=0,i=!1,R=!1;for(t=0,A=e.length;t<A;t++){if(r=e[t],E);else if(r!=Marker.SINGLE_QUOTE||O||T)if(r==Marker.SINGLE_QUOTE&&!O&&T)T=!1;else if(r!=Marker.DOUBLE_QUOTE||O||T)if(r==Marker.DOUBLE_QUOTE&&O&&!T)O=!1;else{if(T||O)continue;_>0&&!i||(r==Marker.OPEN_ROUND_BRACKET?_++:r==Marker.CLOSE_ROUND_BRACKET&&1==_?(_--,i=!1):r==Marker.CLOSE_ROUND_BRACKET?_--:r==Selector.HASH?N[0]++:r==Selector.DOT||r==Marker.OPEN_SQUARE_BRACKET?N[1]++:r!=Selector.PSEUDO||R||isNotPseudoClass(e,t)?r==Selector.PSEUDO?i=!0:(0===t||S)&&LETTER_PATTERN.test(r)&&N[2]++:(N[1]++,i=!1))}else O=!0;else T=!0;E=r==Marker.BACK_SLASH,R=r==Selector.PSEUDO,S=!E&&SEPARATOR_PATTERN.test(r)}return N}function isNotPseudoClass(e,r){return e.indexOf(NOT_PREFIX,r)===r}module.exports=specificity;