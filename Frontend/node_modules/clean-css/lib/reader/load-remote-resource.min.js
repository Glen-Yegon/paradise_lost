var http=require("http"),https=require("https"),url=require("url"),isHttpResource=require("../utils/is-http-resource"),isHttpsResource=require("../utils/is-https-resource"),override=require("../utils/override"),HTTP_PROTOCOL="http:";function loadRemoteResource(e,t,o,r){var u,s=t.protocol||t.hostname,i=!1;u=override(url.parse(e),t||{}),void 0!==t.hostname&&(u.protocol=t.protocol||HTTP_PROTOCOL,u.path=u.href),(s&&!isHttpsResource(s)||isHttpResource(e)?http.get:https.get)(u,function(u){var s=[];if(!i){if(u.statusCode<200||u.statusCode>399)return r(u.statusCode,null);if(u.statusCode>299)return loadRemoteResource(url.resolve(e,u.headers.location),t,o,r);u.on("data",function(e){s.push(e.toString())}),u.on("end",function(){var e=s.join("");r(null,e)})}}).on("error",function(e){i||(i=!0,r(e.message,null))}).on("timeout",function(){i||(i=!0,r("timeout",null))}).setTimeout(o)}module.exports=loadRemoteResource;